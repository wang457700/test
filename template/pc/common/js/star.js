var star=(function(){var extend=function(subClass,superClass){var F=function(){};F.prototype=superClass.prototype;subClass.prototype=new F();subClass.prototype.constructor=subClass;};var Light=function(el,options){this.$el=$(el);this.opts=options;this.$item=this.$el.find('.rating-item');this.add=1;this.selectEvent='mousemove';};Light.prototype.init=function(){this.lightOn(this.opts.num);if(!this.opts.readOnly){this.bindEvent();}};Light.prototype.lightOn=function(num){num=parseInt(num);this.$item.each(function(i){if(i<num){$(this).css('background-position','-47px 0');}else{$(this).css('background-position','0 0');}});};Light.prototype.bindEvent=function(){var self=this,itemLength=self.$item.length;self.$el.on(self.selectEvent,'.rating-item',function(e){var $this=$(this),num=0;self.select(e,$this);num=$(this).index()+self.add;self.lightOn(num);(typeof self.opts.select==='function')&&self.opts.select.call(this,self.num,itemLength);self.$el.trigger('select',[self.opts.num,itemLength]);}).on('click','.rating-item',function(){self.opts.num=$(this).index()+self.add;(typeof self.opts.chosen==='function')&&self.opts.chosen.call(this,self.opts.num,itemLength);self.$el.trigger('chosen',[self.opts.num,itemLength]);}).on('mouesout','.rating-item',function(){self.lightOn(self.opts.num);});};Light.prototype.select=function(){throw new Error('子类必须重写此方法');};Light.prototype.unbindEvent=function(){this.$el.off();};var LightEntire=function(el,options){Light.call(this,el,options);this.selectEvent='mouseover';};extend(LightEntire,Light);LightEntire.prototype.lightOn=function(num){Light.prototype.lightOn.call(this,num);};LightEntire.prototype.select=function(){this.selectEvent='mouseover';};var LightHalf=function(el,options){Light.call(this,el,options);this.selectEvent='mousemove';};extend(LightHalf,Light);LightHalf.prototype.lightOn=function(num){var count=parseInt(num),isHalf=count!==num;Light.prototype.lightOn.call(this,count);if(isHalf){this.$item.eq(count).css('background-position','-93px 0');}};LightHalf.prototype.select=function(e,$this){if(e.pageX-$this.offset().left<$this.width()/2){this.add=0.5;}else{this.add=1;}};var defaults={mode:'LightEntire',num:0,readOnly:false,select:function(){},chosen:function(){}};var mode={'LightEntire':LightEntire,'LightHalf':LightHalf};var init=function(el,option){var $el=$(el),dep=$el.data('deposit'),options=$.extend({},defaults,typeof option==='object'&&option);if(!mode[options.mode]){options.mode='LightEntire';}
if(!dep){$el.data('deposit',(rating=new mode[options.mode](el,options)));rating.init();}
if(typeof option==='string')rating[option]();};$.fn.extend({star:function(option){return this.each(function(){init(this,option);})}});return{init:init}})();